# *Salmonella enterica* Genome Assembly and Comparison
BINF 6110 
Mahnoor Nizamani

## Introduction:

*Salmonella enterica* is a major foodborne pathogen responsible for significant occurrences of illness worldwide, with some strains exhibiting different host specificities and virulence factors. Analyzing genomic variations can help shed light on the reasons for these differences and help with outbreak investigation and monitoring.

Whole-genome sequencing is a vital part of modern bacterial genomics as it enables high-resolution identification of bacterial strains, tracking of outbreaks, and identification of virulence factors and antimicrobial resistance genes. The primary goal of this study was to assemble a *Salmonella enterica* genome from raw reads generated by an Oxford Nanopore (ON) R10 sequencing and compare it to a reference genome in order to identify genetic variations. The workflow included quality control of raw data, de novo genome assembly, alignment to reference genome, variant calling, and final visualization of results.

There are some challenges that may come with genome assembly from long-read sequence data. Despite the recent improvements in ON R10, achieving Q20+ accuracy (99.5%), ON reads used to exhibit higher error rates compared to short-read sequencers like Illumina (Sanderson et al., 2024). The R10 chemistry using improved basecalling models has now significantly reduced said errors, resulting in near-perfect bacterial genomes without the need for short-read polishing (Bogaerts et al., 2024). Computational demands are another challenge in processing large genomic datasets and assemblers must be able to balance accuracy with efficiency. Lastly, repetitive regions, mobile elements, and structural variations can sometimes cause issues with genome assembly, which then requires algorithms that are capable of resolving said complex genomic architectures.

This nanopore only approach simplifies workflow, eliminating the need for separate Illumina sequencing and hybrid assembly. It also allows for complete structural variation detection as long reads can span repetitive regions and resolve complex structural variants that short reads cannot. It also has a rapid turnaround, is cost effective, and has better plasmid resolution as long reads allow for complete plasmid assembly which is crucial for tracking antimicrobial resistance genes.

There are also challenges that come with alignment and variant calling. Whole-genome alignment algorithms have to be able to handle genomic rearrangements, insertions, deletions, and inversions that might occur between different strains (Saada et al., 2024). The choice of alignment method, whether they’re suffix tree-based (MUMmer), anchor-based (Minimap2), or graph-based approaches, can significantly impact the detection of structural variations and single nucleotide polymorphisms (SNPs). Despite the challenges, variant calling using long-read data has shown considerable improvement after the development of deep learning-based approaches. A recent benchmarking study by Hall demonstrated that tools like Clair3, DeepVariant, and Medaka could match or exceed the accuracy of Illumina-based variant calling in bacterial genomes. However, errors related to DNA methylation can still affect variant calling, so careful consideration of basecalling models and polishing methods are necessary (Bogaerts et al., 2025).


## Methods:

### Dataset Description

The dataset for this analysis consisted of Oxford Nanopore R10 chemistry sequencing data for *Salmonella enterica* (NCBI accession: SRR32410565). The reads were generated with expected accuracy of Q20+ (>99% base accuracy) and N50 read lengths ranging from 5-15 kb. The raw reads were provided in FASTQ format containing both sequence data and per-base quality scores. A total of 196,031 reads were sequenced, yielding sufficient coverage for high-quality genome assembly.

### Reference Genome

The reference genome used for alignment and variant calling was *Salmonella enterica* subsp. *enterica* serovar Typhimurium strain LT2, downloaded from NCBI GenBank:

- **Accession:** NC_003197.2 (GCF_000006945.2_ASM694v2)
- **Genome size:** 4,857,432 bp (chromosome)
- **Completeness:** Complete genome assembly

Strain LT2 was selected as the reference because it is one of the most well characterized *S. enterica* strains with a complete, high-quality genome assembly and extensive functional annotation, making it ideal for comparative genomics and variant detection studies.

### Quality Control

Quality assessment of raw Nanopore reads was performed using **NanoPlot v1.46.2** (De Coster et al., 2018):

```bash
NanoPlot --fastq data/raw_reads.fastq \
         --outdir qc \
         --plots dot kde \
         --threads 8
```

**Parameters:**
`--plots dot kde` Was used to generate scatter plots and kernel density estimates to visualize the relationship between read length and quality score distributions, and `--threads 8` to use 8 CPU cores for parallel processing

This quality control step assessed read length distribution (N50, mean, median), quality score distribution, total sequencing yield, and identified any potential contamination or quality issues that could affect downstream assembly.

### Genome Assembly

De novo genome assembly was performed using **Flye v2.9.5** (Kolmogorov et al., 2019):

```bash
flye --nano-hq data/raw_reads.fastq \
     --out-dir assembly \
     --threads 8 \
     --genome-size 5m \
     --iterations 2
```

**Parameters:**
`--nano-hq` Was used as it is a preset optimized for high-quality Nanopore reads (Q20+), which uses error models specifically calibrated for improved basecalling accuracy compared to older chemistries with higher error rates and poorer read quality. `--genome-size 5m` Was used to set the expected genome size to 5 megabases, based on typical *Salmonella* genome sizes (4.8-5.2 Mb), which helps optimize memory allocation and guides initial contig construction algorithms. `--iterations 2` Sets the number of polishing iterations. R10 chemistry with high base accuracy (Q20+) tends to require fewer polishing iterations compared to older chemistry.

Flye was selected over alternative assemblers (Canu, Raven) because it uses a repeat graph approach that has been shown to perform well with bacterial genomes, effectively resolving complex repeat structures such as prophage sequences and insertion elements common in *Salmonella*. Additionally, Flye maintains faster runtimes than Canu while achieving comparable or superior assembly quality for R10 data. (Kolmogorov et al., 2019)

### Assembly Quality Assesment

Assembly quality was evaluated using **QUAST v5.2.0** (Gurevich et al., 2013):

```bash
quast assembly/assembly.fasta \
      -r data/reference.fasta \
      -o qc/quast_results \
      --threads 8
```

QUAST provides comprehensive assembly statistics including N50, L50, number of contigs, total assembly length, genome fraction covered, and misassembly detection when compared against the reference genome.

### Genome Alignment

#### Assembly-to-Reference Alignment

Whole-genome alignment of the assembled contigs to the reference was performed using **Minimap2 v2.28** (Li, 2018):

```bash
# Create minimap2 index for reference
minimap2 -d data/reference.mmi data/reference.fasta

# Align assembly to reference
minimap2 -ax asm5 \
         -t 8 \
         --cs \
         data/reference.mmi \
         assembly/assembly.fasta > alignment/assembly_vs_ref.sam
```

**Parameters:**
`-ax asm5` is an alignment preset for assembly-to-reference comparison, optimized for 5% sequence divergence which is typical for intra-species variation in *Salmonella*. `--cs` was used to generate CS tags containing detailed CIGAR strings, which are needed for accurate downstream variant calling and structural variant detection.

#### Read-to-Reference Alignment

For variant calling, raw reads were aligned to the reference genome as well:

```bash
minimap2 -ax map-ont \
         -t 8 \
         data/reference.fasta \
         data/raw_reads.fastq > alignment/reads_vs_ref.sam
```

**Parameters:**
`-ax map-ont` Is a preset optimized for aligning Oxford Nanopore reads to reference genome.

Both alignments were converted to sorted BAM format using **samtools v1.22.1**, and coverage statistics were also generated using samtools:

```bash
samtools flagstat 
samtools depth 
samtools coverage
```

### Variant Calling

#### SNP and Small Indel Detection

Variant detection from the read alignment was performed using **BCFtools v1.22** (Danecek et al., 2021):

```bash
# Call variants
bcftools mpileup -f data/reference.fasta \
                 alignment/reads_vs_ref.sorted.bam \
                 -Ou | \
bcftools call -v --ploidy 1 -Ov -o variants/raw_variants.vcf

# Filter variants
bcftools filter -i 'QUAL>=20 && DP>=10' \
                variants/raw_variants.vcf \
                -o variants/filtered_variants.vcf
```

**Parameters:**
`--ploidy 1` was used to specify a haploid organism, as the genome is bacterial with a single circular chromosome and the default diploid setting would incorrectly assume heterozygous variants. `-v` outputs variant sites only and `QUAL>=20` sets a minimum Phred quality score of 20, corresponding to 99% confidence in the variant call, while `DP>=10` sets a minimum read depth of 10 reads supporting the variant. This ensures calls are well-supported and reduces false positives from sequencing errors.

These filtering thresholds were selected based on best practices for bacterial variant calling (Olson et al., 2015).

### Structural Variant Calling

Structural variants and comprehensive genome comparison were identified using **MUMmer v4.0.0** (Marçais et al., 2018):

```bash
dnadiff -p variants/comparison \
        data/reference.fasta \
        assembly/assembly.fasta
```

The `dnadiff` tool performs whole-genome alignment using NUCmer and calculates comprehensive statistics including total SNPs, indels, inversions, translocations, relocations, and overall sequence identity. This approach is effective for detecting structural variations that would be missed by traditional read-based variant callers.

### Visualization:

Multiple visualization approaches were employed to examine assembly quality, variant distributions, and genomic features. The assembly graph was visualized using **Bandage v0.8.1** (Wick et al., 2015) to examine contig structure, identify circular contigs (complete chromosomes and plasmids), and detect potential misassemblies. Variants and read alignments were visualized using **Integrative Genomics Viewer (IGV) v2.16.2** (Robinson et al., 2011).IGV allows manual inspection of individual variants, coverage depth patterns, and alignment quality across the genome. This is useful for validating computational variant calls and identifying regions with unusual coverage or alignment patterns that may indicate assembly errors or biological features such as prophages or genomic islands. **ggplot2 v4.0.2**and **circlize v0.4.11** were also used in **R v4.5.2** to visualize read coverage, Variant distribution, and create a circos genome plot.

### Code:

All analysis was performed using the Genome_Assembly_Analysis.sh script in the ubuntu WSL command line, which includes quality control, assembly, alignment, and variant calling steps.

## Results:


### Assembly Statistics
The Flye assembly produced a high-quality genome consisting of 3 contigs with a total length of 5,093,405 bp. Two of the 3 contigs, chromosomes of lengths 3,308,496bp and 1,669.908bp, were connected by a 5,942bp unresolved repeat region and the third contig was a 109,059bp independently assembled plasmid(Figure 1).

![Alt text for the image](https://github.com/mahnoor-nizz/BINF6110-Assignment-1-/blob/main/Visualizations%20%26%20Images/Bandage_graph.png)

**Figure 1:** Assembly graph of the bacterial genome generated by Flye displayed in Bandage showing 3 contigs, including two chromosomes (teal, 3.3 Mb and 1.67 Mb) connected by a repeat region (blue, 5 kb) and one independently assembled plasmid (red, 109 kb).


![Alt text for the image](https://github.com/mahnoor-nizz/BINF6110-Assignment-1-/blob/main/Visualizations%20%26%20Images/circos_genome_plot.png)

**Figure 2:** circular genome plot visualizing sequencing coverage and variant distribution across the Salmonella enterica genome. The outer black track represents average sequencing coverage depth across the genome. Inner tracks display variant positions: blue points indicate SNPs, green points indicate insertions, and red points indicate deletions. Variants are distributed across the chromosome and plasmid, with localized regions of increased variant density suggesting potential mutation clustering.

Nanoplot results showed that there were 196,031 total reads, 809.3 total Mb, and a mean read length of 4,128 bp. The sequence quality was excellent, with a mean quality score of Q18.9 and median quality of Q23.7. Notably, 76.9% of reads exceeded Q20, demonstrating the high performance of R10 chemistry. The sequencing depth (~159x coverage) was more than sufficient for high-quality genome assembly. The N50 read length was 4,683 bp and the longest read was 58,041 bp though the mean basecall quality score for it was quite low (3.2)

### Alignment statistics
Alignment statistics from quast showed a genome fraction of 95.67% with a duplication ratio of 1.002. The total aligned length was 4,747.2 kb, of which the largest alignment was 953.7 kb. dnadiff assembly based calling results showed high sequence identity (99.88%) which confirms that the assembled genome is Salmonella enterica and is very closely related to the Typhimurium serovar LT2 reference strain. However, the 6.49% of unaligned assembly sequence (331,389 bp) from quast suggests this strain contains additional genetic material not present in LT2, of which 109kb represent the plasmid.

Alignment of reads to reference using bcftools resulted in 9450 total variants, of which 9378 were SNPs, 40 were insertions and 32 were deletions. Dnadiff assembly based calling comparison report showed 4,449 total SNPs with 687 of high confidence (GSNPs) and 552 indels 32 of which were of high confidence (GIndels). A Ts/Tv ratio of 1.52 was calculated using dnadiff output results which is consistent with bacterial genomes. 184 Breakpoints indicated substantial genomic plasticity, which is characteristic of Salmonella enterica and contributes to its ability to adapt to diverse environmental niches and hosts.

![Alt text for the image](https://github.com/mahnoor-nizz/BINF6110-Assignment-1-/blob/main/Visualizations%20%26%20Images/igv_snapshot.png)

**Figure 3:** Integrative Genomics Viewer (IGV) screenshot showing variants in a 89 bp region (position 62,960,000-63,050,000 on NC_003277.2). The top track shows filtered variants (blue/cyan bars), middle track shows read alignment with coverage depth, and bottom tracks show individual read alignments with called variants (colored bases) and the reference sequence. Multiple SNPs (single base changes) and indels (insertions/deletions) are visible, all well-supported by high read depth.

The IGV visualization demonstrated high coverage depth as most positions showed >100x coverage (gray bars in coverage track). Called variants (blue/cyan bars in top track) were supported by multiple reads and even coverage across the region indicating good sequencing quality. SNPs are shown as single colored bases and small indels are shown as purple lines indicating insertions or gaps indicating deletions.

![Alt text for the image](https://github.com/mahnoor-nizz/BINF6110-Assignment-1-/blob/main/Visualizations%20%26%20Images/contig%20alignment%20viewer.png)
**Figure 4:** QUAST Contig Alignment Viewer showing how assembled contigs map to the reference genome NC_003197.2 (LT2 strain). The top track represents the reference genome (4.86 Mb total length, indicated by the scale from 0 to 5.09 Mbp). The bottom track shows the assembly contigs (4.95 Mb total) with individual alignments colored and positioned according to their mapping to the reference. Orange/red blocks indicate forward-strand alignments, while purple blocks indicate reverse-complement alignments. 

## Discussion
### Overview of Findings
The genome assembly and comparative analysis successfully generated a high-quality Salmonella enterica genome assembly from Oxford Nanopore R10 sequencing data and identified substantial genetic variation compared to the reference strain LT2. The assembly produced 3 contigs totaling 5.09 Mb, consisting of a two chromosome (3.3 Mb and 1.67 Mb) and one plasmid (109 kb). This represents a 3.2% size increase compared to the reference genome (4.95 Mb), primarily attributable to plasmid content and potential prophage integrations not present in LT2.

The Flye assembly achieved excellent continuity and completeness. High average identity (99.88%) to the reference indicated accurate assembly with minimal errors. Circular chromosome topology (observed in Bandage graph) confirmed complete chromosomal assembly. Uniform high coverage (157-245x) across all contigs provided confidence in base calling accuracy. Low contig number (3) indicated successful resolution of repetitive regions. The read lengths from Nanopore R10 (N50: 4.7 kb) enabled the assembler to span most repetitive elements. 

The variant calling identified 4,449 total SNPs between the assembled genome and LT2 reference, of which 687 were classified as high-confidence based on their presence in well-aligned, non-repetitive regions. This corresponds to approximately 0.14 SNPs per kb of aligned sequence. Most SNPs were scattered throughout the genome rather than clustered, suggesting gradual evolutionary divergence rather than recent recombination events. Higher SNP density is likely to be observed on genes that are not essential for bacterial fitness, while ribosomal proteins, DNA replication machinery, and central metabolic enzymes are likely to show fewer SNPs, reflecting purifying selection to maintain function. The observed Ts/Tv ratio of 1.52 is consistent with bacterial genomes. Transitions (A->G, C->T) are more common than transversions (A->T, C->G) because they are less likely to cause amino acid changes. The analysis also identified 552 total indels, with 32 classified as high-confidence. 

The plasmid (109 kb, 245x coverage) may encode antimicrobial resistance genes, or other virulence factors and higher coverage (245x vs. 169x and 157x) suggests higher copy number, which is expected for smaller plasmids. The dnadiff analysis revealed substantial structural variation, including 17 relocations and 4 inversions, despite this, the overall gene order and structure remain highly conserved (99.88% identity), confirming that both strains belong to *Salmonella enterica* subspecies *enterica*.

The pattern of genetic variation observed reflects the evolutionary history and ecological adaptation of Salmonella enterica. The high overall similarity (~99.88%) represents the core genome, consisting of genes essential for Salmonella biology that are conserved across strains. This includes DNA replication and repair machinery, transcription and translation components, central metabolism, and cell wall biosynthesis.

In contrast, the indels and structural variants represent the accessory genome, which consists of variable elements that differ between strains including plasmids and genomic islands. This core/accessory genome structure is fundamental to bacterial evolution, allowing conservation of essential functions through purifying selection on the core genome, rapid adaptation to new environments through the accessory genome, and diversification without the loss of species identity.

### Public health implications

Understanding genomic variation in Salmonella enterica has important applications in public health. High-resolution genomic comparison enables outbreak investigation and source tracking by distinguishing outbreak-related strains from others in the environment. The presence of plasmids and accessory genome elements allows for antimicrobial resistance surveillance, as resistance genes are often present in plasmids and can be rapidly transferred between strains. Virulence assessment is improved through identification of virulence factors encoded in plasmids that may explain differences in disease severity. Finally, knowledge of conserved core genome elements versus variable accessory genome regions can inform vaccine and diagnostic development.

### Comparison to Alternative Approaches

This Nanopore-only assembly approach offers advantages and disadvantages compared to alternatives. Compared to short-read assembly using Illumina, Nanopore offers far fewer contigs (3 vs. hundreds), complete plasmid assemblies, faster turnaround, and lower cost. However, Illumina provides higher per-base accuracy (Q30-Q40 vs. Q20), lower systematic error rate, and better SNP calling in repetitive regions.

### Future Directions

Future work should focus plasmid characterization through annotation of plasmid sequences and BLAST searches against the NCBI plasmid database could identify similar plasmids and potential resistance genes. Phylogenetic analysis could place this strain in the context of other Salmonella strains to understand evolutionary relationships and outbreak connections. Improved variant calling using advanced approaches such as Clair3 or DeepVariant (deep learning-based variant callers optimized for Nanopore) and implementation of methylation-aware basecalling and variant filtering could enhance accuracy. 

### Conclusion
This genome assembly and comparative genomics analysis successfully generated a high-quality Salmonella enterica genome using Oxford Nanopore R10 long-read sequencing and identified 4,449 SNPs, 552 indels, and multiple structural variants compared to the reference strain LT2. The Nanopore-only workflow proved to be effective for bacterial genome assembly, producing 3 contigs (2 chromosomal segments + 1 plasmid) with >99.88% sequence identity to the reference and excellent assembly continuity.

The analysis revealed substantial genomic differences. While core genome content is conserved (99.88% identity), the presence of a plasmid and prophage variation creates significant accessory genome differences. High-quality variant detection enabled identification of thousands of SNPs and indels, while structural variation detection revealed inversions, translocations, and relocations indicating genomic plasticity.
The identified genetic differences provide insights into strain-level diversity within S. enterica and demonstrate the power of long-read sequencing for resolving complex genomic features including plasmids and mobile genetic elements that would be challenging to detect with short-read approaches alone. 

The presence of a plasmid in this strain, absent from the LT2 reference, is the most striking finding and warrants further investigation to determine if it carries antimicrobial resistance genes, additional virulence factors, or novel metabolic capabilities. This work demonstrates that modern long-read sequencing technology combined with bioinformatics analysis enables comprehensive genomic characterization of bacterial pathogens, supporting public health surveillance, outbreak investigation, and evolutionary studies of this important foodborne pathogen.



References:

  Bogaerts, B., Bossche, A. V. den, Verhaegen, B., Delbrassinne, L., Mattheus, W., Nouws, S., & Godfroid, M. (2024, May 4). Closing the gap: Oxford Nanopore Technologies R10 sequencing allows comparable results to illumina sequencing for SNP-based outbreak investigation of bacterial pathogens. Journal of clinical microbiology. https://doi.org/10.1128/jcm.01576-23 

  Bogaerts, B., Maex, M., Commans, F., & Goeders, N. (2025, August 22). Oxford Nanopore Technologies R10 sequencing enables accurate cgmlst-based bacterial outbreak investigation of neisseria meningitidis and salmonella enterica when accounting for methylation-related errors. Journal of clinical microbiology. https://doi.org/10.1128/jcm.00410-25 

  Danecek, P., Bonfield, J. K., Liddle, J., Marshall, J., Ohan, V., Pollard, M. O., Whitwham, A., Keane, T., McCarthy, S. A., Davies, R. M., & Li, H. (2021). Twelve years of SAMtools and BCFtools. GigaScience, 10(2), giab008. https://doi.org/10.1093/gigascience/giab008

  De Coster, W., D’Hert, S., Schultz, D. T., Cruts, M., & Van Broeckhoven, C. (2018, August 1). NanoPack: Visualizing and processing long-read sequencing data. Bioinformatics (Oxford, England). https://doi.org/10.1093/bioinformatics/bty149 

  Gurevich, A., Saveliev, V., Vyahhi, N., & Tesler, G. (2013). QUAST: Quality assessment tool for genome assemblies. Bioinformatics, 29(8), 1072-1075. https://doi.org/10.1093/bioinformatics/btt086

  Hall, M. B., Wick, R. R., Judd, L. M., Nguyen, A. N., Steinig, E. J., Xie, O., Davies, M., Seemann, T., Stinear, T. P., & Coin, L. (2024, October 10). Benchmarking reveals superiority of deep learning variant callers on bacterial nanopore sequence data. eLife. https://doi.org/10.7554/elife.98300 

  Kolmogorov, M., Yuan, J., Lin, Y., & Pevzner, P. A. (2019, April 1). Assembly of long, error-prone reads using repeat graphs. Nature News. https://doi.org/10.1038/s41587-019-0072-8 

  Li, H. (2018, September). Minimap2: Pairwise alignment for nucleotide sequences | bioinformatics | oxford academic. Oxford Academic. https://doi.org/10.1093/bioinformatics/bty191 

  Marçais, G., Delcher, A. L., Phillippy, A. M., Coston, R., Salzberg, S. L., & Zimin, A. (2018). MUMmer4: A fast and versatile genome alignment system. PLOS Computational Biology, 14(1), e1005944. https://doi.org/10.1371/journal.pcbi.1005944

  Saada, B., Zhang, T., Siga, E., Zhang, J., & Magalhães Muniz, M. M. (2024, June 3). Whole-genome alignment: Methods, challenges, and future directions. MDPI. https://doi.org/10.3390/app14114837 

  Sanderson, N. D., Hopkins, K. M. V., Colpus, M., Parker, M., Lipworth, S., Crook, D., & Stoesser, N. (2024, May 7). Evaluation of the accuracy of bacterial genome reconstruction with Oxford nanopore R10.4.1 long-read-only sequencing. microbiologyresearch.org. https://doi.org/10.1099/mgen.0.001246 

  Wick, R. R., Schultz, M. B., Zobel, J., & Holt, K. E. (2015). Bandage: Interactive visualization of de novo genome assemblies. Bioinformatics, 31(20), 3350-3352. https://doi.org/10.1093/bioinformatics/btv383

  https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax
