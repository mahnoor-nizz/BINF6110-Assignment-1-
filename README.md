# *Salmonella enterica* Genome Assembly and Comparison
BINF 6110 
Mahnoor Nizamani

## Introduction:

*Salmonella enterica* is a major foodborne pathogen responsible for significant occurrences of illness worldwide, with some strains exhibiting different host specificities and virulence factors. Analyzing genomic variations can help shed light on the reasons for these differences and help with outbreak investigation and monitoring.

Whole-genome sequencing is a vital part of modern bacterial genomics as it enables high-resolution identification of bacterial strains, tracking of outbreaks, and identification of virulence factors and antimicrobial resistance genes. The primary goal of this study was to assemble a *Salmonella enterica* genome from raw reads generated by an Oxford Nanopore (ON) R10 sequencing and compare it to a reference genome in order to identify genetic variations. The workflow included quality control of raw data, de novo genome assembly, alignment to reference genome, variant calling, and final visualization of results.

There are some challenges that may come with genome assembly from long-read sequence data. Despite the recent improvements in ON R10, achieving Q20+ accuracy (99.5%), ON reads used to exhibit higher error rates compared to short-read sequencers like Illumina (Sanderson et al., 2024). The R10 chemistry using improved basecalling models has now significantly reduced said errors, resulting in near-perfect bacterial genomes without the need for short-read polishing (Bogaerts et al., 2024). Computational demands are another challenge in processing large genomic datasets and assemblers must be able to balance accuracy with efficiency. Lastly, repetitive regions, mobile elements, and structural variations can sometimes cause issues with genome assembly, which then requires algorithms that are capable of resolving said complex genomic architectures.

This nanopore only approach simplifies workflow, eliminating the need for separate Illumina sequencing and hybrid assembly. It also allows for complete structural variation detection as long reads can span repetitive regions and resolve complex structural variants that short reads cannot. It also has a rapid turnaround, is cost effective, and has better plasmid resolution as long reads allow for complete plasmid assembly which is crucial for tracking antimicrobial resistance genes.

There are also challenges that come with alignment and variant calling. Whole-genome alignment algorithms have to be able to handle genomic rearrangements, insertions, deletions, and inversions that might occur between different strains (Saada et al., 2024). The choice of alignment method, whether they’re suffix tree-based (MUMmer), anchor-based (Minimap2), or graph-based approaches, can significantly impact the detection of structural variations and single nucleotide polymorphisms (SNPs). Despite the challenges, variant calling using long-read data has shown considerable improvement after the development of deep learning-based approaches. A recent benchmarking study by Hall demonstrated that tools like Clair3, DeepVariant, and Medaka could match or exceed the accuracy of Illumina-based variant calling in bacterial genomes. However, errors related to DNA methylation can still affect variant calling, so careful consideration of basecalling models and polishing methods are necessary (Bogaerts et al., 2025).


## Methods:

### Dataset Description

The dataset for this analysis consisted of Oxford Nanopore R10 chemistry sequencing data for *Salmonella enterica* (NCBI accession: SRR32410565). The reads were generated with expected accuracy of Q20+ (>99% base accuracy) and N50 read lengths ranging from 5-15 kb. The raw reads were provided in FASTQ format containing both sequence data and per-base quality scores. A total of 196,031 reads were sequenced, yielding sufficient coverage for high-quality genome assembly.

### Reference Genome

The reference genome used for alignment and variant calling was *Salmonella enterica* subsp. *enterica* serovar Typhimurium strain LT2, downloaded from NCBI GenBank:

- **Accession:** NC_003197.2 (GCF_000006945.2_ASM694v2)
- **Genome size:** 4,857,432 bp (chromosome)
- **Completeness:** Complete genome assembly, single circular chromosome

Strain LT2 was selected as the reference because it is one of the most well characterized *S. enterica* strains with a complete, high-quality genome assembly and extensive functional annotation, making it ideal for comparative genomics and variant detection studies.

### Quality Control

Quality assessment of raw Nanopore reads was performed using **NanoPlot v1.46.2** (De Coster et al., 2018):

```bash
NanoPlot --fastq data/raw_reads.fastq \
         --outdir qc \
         --plots dot kde \
         --threads 8
```

**Parameters:**
`--plots dot kde` Was used to generate scatter plots and kernel density estimates to visualize the relationship between read length and quality score distributions, and `--threads 8` to use 8 CPU cores for parallel processing

This quality control step assessed read length distribution (N50, mean, median), quality score distribution, total sequencing yield, and identified any potential contamination or quality issues that could affect downstream assembly.

### Genome Assembly

De novo genome assembly was performed using **Flye v2.9.5** (Kolmogorov et al., 2019):

```bash
flye --nano-hq data/raw_reads.fastq \
     --out-dir assembly \
     --threads 8 \
     --genome-size 5m \
     --iterations 2
```

**Parameters:**
`--nano-hq` Was used as it is a preset optimized for high-quality Nanopore reads (Q20+), which uses error models specifically calibrated for improved basecalling accuracy compared to older chemistries with higher error rates and poorer read quality. `--genome-size 5m` Was used to set the expected genome size to 5 megabases, based on typical *Salmonella* genome sizes (4.8-5.2 Mb), which helps optimize memory allocation and guides initial contig construction algorithms. `--iterations 2` Sets the number of polishing iterations. R10 chemistry with high base accuracy (Q20+) tends to require fewer polishing iterations compared to older chemistry.

Flye was selected over alternative assemblers (Canu, Raven) because it uses a repeat graph approach that has been shown to perform well with bacterial genomes, effectively resolving complex repeat structures such as prophage sequences and insertion elements common in *Salmonella*. Additionally, Flye maintains faster runtimes than Canu while achieving comparable or superior assembly quality for R10 data. (Kolmogorov et al., 2019)

### Assembly Quality Assesment

Assembly quality was evaluated using **QUAST v5.2.0** (Gurevich et al., 2013):

```bash
quast assembly/assembly.fasta \
      -r data/reference.fasta \
      -o qc/quast_results \
      --threads 8
```

QUAST provides comprehensive assembly statistics including N50, L50, number of contigs, total assembly length, genome fraction covered, and misassembly detection when compared against the reference genome.

### Genome Alignment

#### Assembly-to-Reference Alignment

Whole-genome alignment of the assembled contigs to the reference was performed using **Minimap2 v2.28** (Li, 2018):

```bash
# Create minimap2 index for reference
minimap2 -d data/reference.mmi data/reference.fasta

# Align assembly to reference
minimap2 -ax asm5 \
         -t 8 \
         --cs \
         data/reference.mmi \
         assembly/assembly.fasta > alignment/assembly_vs_ref.sam
```

**Parameters:**
`-ax asm5` is an alignment preset for assembly-to-reference comparison, optimized for 5% sequence divergence which is typical for intra-species variation in *Salmonella*. `--cs` was used to generate CS tags containing detailed CIGAR strings, which are needed for accurate downstream variant calling and structural variant detection.

#### Read-to-Reference Alignment

For variant calling, raw reads were aligned to the reference genome as well:

```bash
minimap2 -ax map-ont \
         -t 8 \
         data/reference.fasta \
         data/raw_reads.fastq > alignment/reads_vs_ref.sam
```

**Parameters:**
`-ax map-ont` Is a preset optimized for aligning Oxford Nanopore reads to reference genome.

Both alignments were converted to sorted BAM format using **samtools v1.22.1**, and coverage statistics were also generated using samtools:

```bash
samtools flagstat 
samtools depth 
samtools coverage
```

### Variant Calling

#### SNP and Small Indel Detection

Variant detection from the read alignment was performed using **BCFtools v1.22** (Danecek et al., 2021):

```bash
# Call variants
bcftools mpileup -f data/reference.fasta \
                 alignment/reads_vs_ref.sorted.bam \
                 -Ou | \
bcftools call -v --ploidy 1 -Ov -o variants/raw_variants.vcf

# Filter variants
bcftools filter -i 'QUAL>=20 && DP>=10' \
                variants/raw_variants.vcf \
                -o variants/filtered_variants.vcf

# Generate stats
bcftools stats variants/filtered_variants.vcf > variants/variant_stats.txt
```

**Parameters:**
`--ploidy 1` was used to specify a haploid organism, as the genome is bacterial with a single circular chromosome and the default diploid setting would incorrectly assume heterozygous variants. `-v` outputs variant sites only and `QUAL>=20` sets a minimum Phred quality score of 20, corresponding to 99% confidence in the variant call, while `DP>=10` sets a minimum read depth of 10 reads supporting the variant. This ensures calls are well-supported and reduces false positives from sequencing errors.

These filtering thresholds were selected based on best practices for bacterial variant calling (Olson et al., 2015).

#### Structural Variant Detection

Structural variants and comprehensive genome comparison were identified using **MUMmer v4.0.0** (Marçais et al., 2018):

```bash
dnadiff -p variants/comparison \
        data/reference.fasta \
        assembly/assembly.fasta
```

The `dnadiff` tool performs whole-genome alignment using NUCmer and calculates comprehensive statistics including total SNPs, indels, inversions, translocations, relocations, and overall sequence identity. This approach is effective for detecting structural variations that would be missed by traditional read-based variant callers.

### Visualization

Multiple visualization approaches were employed to examine assembly quality, variant distributions, and genomic features:

#### 1. Assembly Graph Visualization

The assembly graph was visualized using **Bandage v0.8.1** (Wick et al., 2015) to examine contig structure, identify circular contigs (complete chromosomes and plasmids), and detect potential misassemblies:

```bash
Bandage image assembly/assembly_graph.gfa assembly_graph.png
```





In this analysis, a Nanopore-only workflow was followed using Oxford Nanopore R10 chemistry sequencing data. This approach takes advantage of the recent technological advances, making long-read only assemblies accurate without requiring hybrid approaches. 
Quality control will be performed using NanoPlot v1.46.2 (De Coster et al., 2018) to assess read length distribution, quality scores, and sequencing yield.
There are several assembler options for long-read bacterial genome assembly. Flye version 2.9.6 was chosen over others like Canu and Raven as it uses a repeat graph approach proven to perform well with bacterial genomes, and has the ability to handle long-read data efficiently while maintaining faster runtimes than Canu (Kolmogorov et al., 2019). After assembly I will use Medaka version 2.2.0 for consensus polishing as it uses neural networks trained on nanopore data to correct errors introduced in basecalling. For whole-genome alignment and variant calling I will use Minimap2 version 2.20 over MUMmer4 because while MUMmer is good for detecting structural variations, Minimap2 has improved speed and is better optimized for Nanopore reads (Li, 2018; Saada et al., 2024). Variant detection will be done also using Medaka as it is optimized for nanopore data. Recent benchmarking studies showed that it achieved F1 scores exceeding 99% for SNPs and 95% for indels with R10 data and high-accuracy basecalling (Hall et al., 2024), making it a better choice compared to BCFtools for this project. 

References:

  Bogaerts, B., Bossche, A. V. den, Verhaegen, B., Delbrassinne, L., Mattheus, W., Nouws, S., & Godfroid, M. (2024, May 4). Closing the gap: Oxford Nanopore Technologies R10 sequencing allows comparable results to illumina sequencing for SNP-based outbreak investigation of bacterial pathogens. Journal of clinical microbiology. https://doi.org/10.1128/jcm.01576-23 

  Bogaerts, B., Maex, M., Commans, F., & Goeders, N. (2025, August 22). Oxford Nanopore Technologies R10 sequencing enables accurate cgmlst-based bacterial outbreak investigation of neisseria meningitidis and salmonella enterica when accounting for methylation-related errors. Journal of clinical microbiology. https://doi.org/10.1128/jcm.00410-25 

  De Coster, W., D’Hert, S., Schultz, D. T., Cruts, M., & Van Broeckhoven, C. (2018, August 1). NanoPack: Visualizing and processing long-read sequencing data. Bioinformatics (Oxford, England). https://doi.org/10.1093/bioinformatics/bty149 

  Hall, M. B., Wick, R. R., Judd, L. M., Nguyen, A. N., Steinig, E. J., Xie, O., Davies, M., Seemann, T., Stinear, T. P., & Coin, L. (2024, October 10). Benchmarking reveals superiority of deep learning variant callers on bacterial nanopore sequence data. eLife. https://doi.org/10.7554/elife.98300 

  Kolmogorov, M., Yuan, J., Lin, Y., & Pevzner, P. A. (2019, April 1). Assembly of long, error-prone reads using repeat graphs. Nature News. https://doi.org/10.1038/s41587-019-0072-8 

  Li, H. (2018, September). Minimap2: Pairwise alignment for nucleotide sequences | bioinformatics | oxford academic. Oxford Academic. https://doi.org/10.1093/bioinformatics/bty191 

  Saada, B., Zhang, T., Siga, E., Zhang, J., & Magalhães Muniz, M. M. (2024, June 3). Whole-genome alignment: Methods, challenges, and future directions. MDPI. https://doi.org/10.3390/app14114837 

  Sanderson, N. D., Hopkins, K. M. V., Colpus, M., Parker, M., Lipworth, S., Crook, D., & Stoesser, N. (2024, May 7). Evaluation of the accuracy of bacterial genome reconstruction with Oxford nanopore R10.4.1 long-read-only sequencing. microbiologyresearch.org. https://doi.org/10.1099/mgen.0.001246 





Part 2

Methods redone/finalized:

Dataset Description
The dataset for this analysis consists of Oxford Nanopore R10 chemistry sequencing data of Salmonella enterica. The reads had an expected accuracy of Q20+ and an N50 read length ranging from 5-15 kb. The raw reads were provided in FASTQ format containing both sequence data and per-base quality scores.

Reference genome
The reference genome used for alignment and variant calling was Salmonella enterica subsp. enterica serovar Typhimurium strain LT2 (GenBank accession: NC_003197.2).

This strain was chosen because it is one of the most well-characterized S. enterica strains with a complete, high-quality genome assembly and extensive annotation, making it ideal for comparative genomics and variant detection

quality control
Quality assessment of raw Nanopore reads was performed using NanoPlot v1.46.2 (De Coster et al., 2018)


